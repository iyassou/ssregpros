# Example YAML file.
seed: 0xCAFE
batch_size: 2
dataset_split: [0.8, 0.1, 0.1]
# Above yields (21, 6, 6) because stratified on patient ID

preprocessor:
  mri_orientation: "RAS"
  mri_patch_size: 128
  pixel_spacing_millimetres: 0.5
  mri_mask_prostate_area_square_millimetres_threshold: 200
  macenko_pixel_count_threshold: 50000

registration_network:
  height: 128
  width: 128
  model_name: "resnet18"
  regression_head_bottleneck_layer_size: 256
  regression_head_shrinkage_range: [0, 0.5]

training:
  checkpointer_cleanup_on_exit: false
  gradient_accumulation_steps: 1
  # Training Scheme
  monitored_validation_metric: ncc_loss
  early_stopping_mode: min
  early_stopping_min_delta_rel: 0.1
  early_stopping_min_delta_abs: 0
  # > Phase A
  lp_early_stopping_min_epochs: 0
  lp_max_epochs: 5
  lp_patience_steps: 126 # len(training) * 6
  lp_learning_rate: 0.001
  lp_weight_decay: 0.01
  # > Phase B
  ft_early_stopping_min_epochs: 0
  ft_max_epochs: 5
  ft_patience_steps: 126 # len(training) * 6
  ft_learning_rate: 0.001
  ft_weight_decay: 0.01
  ft_unfreeze_plan: ["layer4", "layer3", "layer2", "layer1"]
  ft_unfreeze_learning_rate_multipliers: [1, 0.5, 0.25, 0.125]
  ft_unfreeze_min_delta_rel: 0.1
  ft_unfreeze_min_delta_abs: 0
  ft_unfreeze_patience_steps: 1

loss:
  ncc_weight: 1
  sobel_weight: 0
  boundary_heatmap_weight: 0
  transformation_parameters_weight: 1
  regularisation:
    translation_weight: 1
    scale_weight: 1
    scale_log_prior_confidence_interval: 0.95
    regression_head_shrinkage_range: [0, 0.5]
