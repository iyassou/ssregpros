from pathlib import Path

import json
import zlib

# NOTE: 'corrs.bin' is assumed to be generated by scripts/Histo-MRI/extract.py
#       when run on the Markdown exports.
CORRESPONDENCES_BINARY = Path(__file__).parent / "corrs.bin"
if not CORRESPONDENCES_BINARY.exists():
    raise FileNotFoundError("could not find correspondences binary file!")

# NOTE: correspondences here take form:
#       (1) patient_id: str
#       (2) histology_id: str
#       (3) t2w_slice_index: int
with open(CORRESPONDENCES_BINARY, "rb") as handle:
    HISTO_MRI_BASE_CORRESPONDENCES: list[tuple[str, str, int]] = [
        tuple(x) for x in json.loads(zlib.decompress(handle.read()))
    ]
